<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Guardtime KSI c SDK: /media/sf_GuardTime/test/libksi-docgen/src/ksi/fast_tlv.h File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Guardtime KSI c SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="../../dir_e9dd2f17e68fadc18218701a3417cccb.html">ksi</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fast_tlv.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
</div>
<p><a href="../../dd/ded/fast__tlv_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d1/dca/structfast__tlv__s.html">fast_tlv_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aabe4e6a9bc65adcde58c02e3c70a83b6"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="../../d1/dca/structfast__tlv__s.html">fast_tlv_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a></td></tr>
<tr class="separator:aabe4e6a9bc65adcde58c02e3c70a83b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a8d7d0ce427b3d1c889edac84bd74de78"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/ded/fast__tlv_8h.html#a8d7d0ce427b3d1c889edac84bd74de78">KSI_Serialize_Opt_en</a> { <a class="el" href="../../dd/ded/fast__tlv_8h.html#a8d7d0ce427b3d1c889edac84bd74de78a1a4f929f63e9e6620470228f333706bb">KSI_TLV_OPT_NO_HEADER</a> = 0x01
, <a class="el" href="../../dd/ded/fast__tlv_8h.html#a8d7d0ce427b3d1c889edac84bd74de78a75f317b3b3c3cfba1a86d8a01e8bbdd4">KSI_TLV_OPT_NO_MOVE</a> = 0x02
 }</td></tr>
<tr class="separator:a8d7d0ce427b3d1c889edac84bd74de78"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9306c079957e2503f56059d5467a7d4f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/ded/fast__tlv_8h.html#a9306c079957e2503f56059d5467a7d4f">KSI_FTLV_fileRead</a> (FILE *f, unsigned char *buf, size_t len, size_t *consumed, struct <a class="el" href="../../d1/dca/structfast__tlv__s.html">fast_tlv_s</a> *t)</td></tr>
<tr class="separator:a9306c079957e2503f56059d5467a7d4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a441f8770e88e9281fb0fb385784b001a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/ded/fast__tlv_8h.html#a441f8770e88e9281fb0fb385784b001a">KSI_FTLV_socketRead</a> (int fd, unsigned char *buf, size_t len, size_t *consumed, <a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a> *t)</td></tr>
<tr class="separator:a441f8770e88e9281fb0fb385784b001a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73d8484c2437e3f513f7de0458f6f73a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/ded/fast__tlv_8h.html#a73d8484c2437e3f513f7de0458f6f73a">KSI_FTLV_memRead</a> (const unsigned char *m, size_t l, <a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a> *t)</td></tr>
<tr class="separator:a73d8484c2437e3f513f7de0458f6f73a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c13778eefe6f374125ac5bc4f98221c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/ded/fast__tlv_8h.html#a8c13778eefe6f374125ac5bc4f98221c">KSI_FTLV_memReadN</a> (const unsigned char *buf, size_t buf_len, <a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a> *arr, size_t arr_len, size_t *rd)</td></tr>
<tr class="separator:a8c13778eefe6f374125ac5bc4f98221c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="aabe4e6a9bc65adcde58c02e3c70a83b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabe4e6a9bc65adcde58c02e3c70a83b6">&#9670;&nbsp;</a></span>KSI_FTLV</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="../../d1/dca/structfast__tlv__s.html">fast_tlv_s</a> <a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a8d7d0ce427b3d1c889edac84bd74de78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d7d0ce427b3d1c889edac84bd74de78">&#9670;&nbsp;</a></span>KSI_Serialize_Opt_en</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="../../dd/ded/fast__tlv_8h.html#a8d7d0ce427b3d1c889edac84bd74de78">KSI_Serialize_Opt_en</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a8d7d0ce427b3d1c889edac84bd74de78a1a4f929f63e9e6620470228f333706bb"></a>KSI_TLV_OPT_NO_HEADER&#160;</td><td class="fielddoc"><p>Do not write the header while serializing. </p>
</td></tr>
<tr><td class="fieldname"><a id="a8d7d0ce427b3d1c889edac84bd74de78a75f317b3b3c3cfba1a86d8a01e8bbdd4"></a>KSI_TLV_OPT_NO_MOVE&#160;</td><td class="fielddoc"><p>Keep the TLV serialized to the end of the buffer. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9306c079957e2503f56059d5467a7d4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9306c079957e2503f56059d5467a7d4f">&#9670;&nbsp;</a></span>KSI_FTLV_fileRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_FTLV_fileRead </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>consumed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="../../d1/dca/structfast__tlv__s.html">fast_tlv_s</a> *&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read the TLV from a file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">f</td><td>File descriptor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Pointer to memory buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the buffer. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">consumed</td><td>Number of bytes read. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Pointer to the <a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code>KSI_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
<a id="a73d8484c2437e3f513f7de0458f6f73a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73d8484c2437e3f513f7de0458f6f73a">&#9670;&nbsp;</a></span>KSI_FTLV_memRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_FTLV_memRead </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a> *&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read the TLV from a memory buffer. This function will try to parse as much information as possible even if the input is not complete (e.g. even the header is not fully available). It will return <a class="el" href="../../dd/df2/group__base.html#gga80cba280da561d1b02728cd946645197a457f8614f99ec7a367d4ca638f0fcdaa">KSI_OK</a> only if the header is fully available. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">m</td><td>Pointer to the memory buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">l</td><td>Length of the buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Pointer to the <a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code>KSI_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>
<dl class="section note"><dt>Note</dt><dd>The function does not initiate the output variable if there is an issue parsing the TLV. </dd></dl>

</div>
</div>
<a id="a8c13778eefe6f374125ac5bc4f98221c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c13778eefe6f374125ac5bc4f98221c">&#9670;&nbsp;</a></span>KSI_FTLV_memReadN()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_FTLV_memReadN </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>buf_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a> *&#160;</td>
          <td class="paramname"><em>arr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>arr_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>rd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Reads up to <code>arr_len</code> TLV's from the buffer. The number of read elements is returned via <code>rd</code> output parameter. If the <code>arr</code> pointer is set to <code>NULL</code> and <code>arr_len</code> equals 0, the function calculates the required length for the buffer <code>arr</code>. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Pointer to the memory buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf_len</td><td>Length of the buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arr</td><td>Pointer to the output buffer (can be <code>NULL</code>). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arr_len</td><td>Length of the output buffer (must be equal to 0, if <code>arr</code> is <code>NULL</code>). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rd</td><td>Output parameter for the number of TLV read (can be <code>NULL</code>). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code>KSI_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>
<dl class="section note"><dt>Note</dt><dd>This method is using optimized to do as little copy operations as possible. In case of an error during this process, the buffer will probably get corrupted. If this corruption of the buffer is an issue, you may call this function twice - the first time just leave <code>arr</code> as <code>NULL</code> and <code>arr_len</code> equal to 0. </dd></dl>

</div>
</div>
<a id="a441f8770e88e9281fb0fb385784b001a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a441f8770e88e9281fb0fb385784b001a">&#9670;&nbsp;</a></span>KSI_FTLV_socketRead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int KSI_FTLV_socketRead </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>consumed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a> *&#160;</td>
          <td class="paramname"><em>t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read the TLV from a socket. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fd</td><td>Socket descriptor. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>Pointer to memory buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>Length of the buffer. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">consumed</td><td>Number of bytes read. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Pointer to the <a class="el" href="../../dd/ded/fast__tlv_8h.html#aabe4e6a9bc65adcde58c02e3c70a83b6">KSI_FTLV</a> object. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>status code (<code>KSI_OK</code>, when operation succeeded, otherwise an error code). </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
